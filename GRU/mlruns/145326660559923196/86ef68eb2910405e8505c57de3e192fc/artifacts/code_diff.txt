diff --git a/python_program/05_model_gru.py b/python_program/05_model_gru.py
index a28ea27..5b37f74 100644
--- a/python_program/05_model_gru.py
+++ b/python_program/05_model_gru.py
@@ -2,126 +2,94 @@ import qlib
 from qlib.constant import REG_CN
 from qlib.utils import init_instance_by_config
 from qlib.workflow import R
-# ç›´æ¥ä½¿ç”¨å®˜æ–¹ç±»ï¼Œä¸æè‡ªå®šä¹‰ç»§æ‰¿äº†
-from qlib.data.dataset.handler import DataHandlerLP
 import pandas as pd
-import os
+import torch
 
-# 1. åˆå§‹åŒ–
+# 1. åˆå§‹åŒ– (è¿æ¥ä½ çš„ E ç›˜ç²®ä»“)
 provider_uri = r"E:\Quant_program\Qlib-Cache\cn_data"
 qlib.init(provider_uri=provider_uri, region=REG_CN)
 
-# 2. å®šä¹‰è‡ªå®šä¹‰å› å­ (çº¯å…¬å¼åˆ—è¡¨)
-custom_factors = [
-    "( $close - Mean($close, 5) ) / Mean($close, 5)",  # 5æ—¥ä¹–ç¦»
-    "$volume / Mean($volume, 20)",  # é‡æ¯”
-    "Std($close, 20) / $close",  # æ³¢åŠ¨ç‡
-    "($open - Ref($close, 1)) / Ref($close, 1)",  # éš”å¤œè·³ç©º
-    "($close - $open) / $open"  # æ—¥å†…åŠ›åº¦
-]
-
-# 3. é…ç½®å·¥ä½œæµ
+# 2. é…ç½®å·¥ä½œæµ
 market = "csi300"
 benchmark = "SH000300"
-FIT_START = "2018-01-01"
-FIT_END = "2020-12-31"
 
+# å®šä¹‰ Handler é…ç½® (ç›´æ¥ç”¨ç°æˆçš„ Alpha158ï¼Œç¨³å¦‚æ³°å±±)
 data_handler_config = {
-    "start_time": "2018-01-01",
+    "start_time": "2015-01-01",
     "end_time": "2022-12-31",
-
-    # âš ï¸ã€å…³é”®ä¿®æ”¹ã€‘è¿™é‡Œåƒä¸‡ä¸è¦å†™ fit_start_timeï¼
-    # å¦‚æœå†™äº†ï¼ŒDataHandlerLP å°±ä¼šæŠ¥é”™ "unexpected argument"ã€‚
-    # "fit_start_time": FIT_START,  <-- åˆ é™¤
-    # "fit_end_time": FIT_END,      <-- åˆ é™¤
-
+    "fit_start_time": "2015-01-01",
+    "fit_end_time": "2020-12-31",
     "instruments": market,
-
-    # æ•°æ®åŠ è½½é…ç½®
-    "data_loader": {
-        "class": "QlibDataLoader",
-        "module_path": "qlib.data.dataset.loader",
-        "kwargs": {
-            "config": {
-                "feature": custom_factors,
-                "label": ["Ref($close, -5) / $close - 1"],
-            },
-        },
-    },
-
-    # ğŸ”¥ğŸ”¥ğŸ”¥ã€å…³é”®ä¿®æ”¹ã€‘åœ¨è¿™é‡Œæ˜¾å¼æ³¨å…¥æ—¶é—´å‚æ•° ğŸ”¥ğŸ”¥ğŸ”¥
-    # è¿™æ ·åº•å±‚å¤„ç†å™¨èƒ½æ‹¿åˆ°å‚æ•°ï¼Œè€Œä¸Šå±‚ Handler åˆä¸ä¼šæŠ¥é”™
+    # æ·±åº¦å­¦ä¹ é€šå¸¸éœ€è¦å½’ä¸€åŒ–åˆ° (0,1) æˆ– (-1,1)
     "infer_processors": [
-        {
-            "class": "RobustZScoreNorm",
-            "kwargs": {
-                "fields_group": "feature",
-                "clip_outlier": True,
-                "fit_start_time": FIT_START,  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
-                "fit_end_time": FIT_END  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
-            }
-        },
+        {"class": "RobustZScoreNorm", "kwargs": {"fields_group": "feature", "clip_outlier": True}},
         {"class": "Fillna", "kwargs": {"fields_group": "feature"}},
     ],
     "learn_processors": [
         {"class": "DropnaLabel"},
-        {
-            "class": "CSRankNorm",
-            "kwargs": {
-                "fields_group": "label",
-                "fit_start_time": FIT_START,  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
-                "fit_end_time": FIT_END  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
-            }
-        },
+        {"class": "CSRankNorm", "kwargs": {"fields_group": "label"}},
     ],
+    "label": ["Ref($close, -5) / $close - 1"],
 }
 
+# ğŸ”¥ æ ¸å¿ƒå˜åŒ–ï¼šæ¨¡å‹ä¸æ•°æ®é›† ğŸ”¥
 task = {
     "model": {
-        "class": "LGBModel",
-        "module_path": "qlib.contrib.model.gbdt",
+        "class": "GRU",  # ä½¿ç”¨é—¨æ§å¾ªç¯å•å…ƒç¥ç»ç½‘ç»œ
+        "module_path": "qlib.contrib.model.pytorch_gru",
         "kwargs": {
+            # æ¨¡å‹ç»“æ„å‚æ•°
+            "d_feat": 158,  # è¾“å…¥ç‰¹å¾ç»´åº¦ (Alpha158)
+            "hidden_size": 64,  # éšè—å±‚ç¥ç»å…ƒæ•°é‡
+            "num_layers": 2,  # RNN å±‚æ•°
+            "dropout": 0.0,  # é˜²æ­¢è¿‡æ‹Ÿåˆ
+
+            # è®­ç»ƒå‚æ•°
+            "n_epochs": 10,  # è®­ç»ƒè½®æ•° (Epochs)
+            "lr": 1e-3,  # å­¦ä¹ ç‡
+            "early_stop": 5,  # æ—©åœè½®æ•°
+            "batch_size": 800,  # æ‰¹å¤§å°
+            "metric": "loss",
             "loss": "mse",
-            "colsample_bytree": 0.8879,
-            "learning_rate": 0.0421,
-            "subsample": 0.8789,
-            "lambda_l1": 205.6999,
-            "lambda_l2": 580.9768,
-            "max_depth": 8,
-            "num_leaves": 210,
-            "num_threads": 20,
+            "GPU": 0 if torch.cuda.is_available() else -1,  # è‡ªåŠ¨æ£€æµ‹ GPU
         },
     },
     "dataset": {
-        "class": "DatasetH",
+        # ğŸ”¥ æ³¨æ„ï¼šè¿™é‡Œå˜æˆäº† TSDatasetH (Time-Series Dataset)
+        # å› ä¸º RNN éœ€è¦åƒè¿›å»ä¸€ä¸ªåºåˆ— (Sequence)ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€è¡Œæ•°æ®
+        "class": "TSDatasetH",
         "module_path": "qlib.data.dataset",
         "kwargs": {
             "handler": {
-                # ç›´æ¥ç”¨å®˜æ–¹ç±»ï¼Œé€šè¿‡é…ç½®è§£å†³é—®é¢˜
-                "class": "DataHandlerLP",
-                "module_path": "qlib.data.dataset.handler",
+                "class": "Alpha158",
+                "module_path": "qlib.contrib.data.handler",
                 "kwargs": data_handler_config,
             },
             "segments": {
-                "train": (FIT_START, FIT_END),
+                "train": ("2015-01-01", "2020-12-31"),
                 "valid": ("2021-01-01", "2021-12-31"),
                 "test": ("2022-01-01", "2022-12-31"),
             },
+            "step_len": 20,  # ğŸ”¥ æ ¸å¿ƒå‚æ•°ï¼šå¾€å›çœ‹ 20 å¤©
+            # æ„æ€æ˜¯ï¼šç”¨è¿‡å» 20 å¤©çš„ Alpha158 æ•°æ®ï¼Œé¢„æµ‹æœªæ¥çš„æ”¶ç›Š
         },
     },
 }
 
 if __name__ == "__main__":
-    with R.start(experiment_name="research_custom_factors"):
-        print("ğŸ§ª æ­£åœ¨è¿›è¡Œè‡ªå®šä¹‰å› å­å®éªŒ (Precise Config)...")
-        print(f"å› å­æ•°é‡: {len(custom_factors)}")
+    with R.start(experiment_name="research_gru_model"):
+        print("ğŸ§  æ­£åœ¨å¯åŠ¨æ·±åº¦å­¦ä¹ æ¨¡å‹ (GRU)...")
+        print(f"   è®¾å¤‡çŠ¶æ€: {'GPU ğŸš€' if torch.cuda.is_available() else 'CPU ğŸ¢ (å¯èƒ½ä¼šæ…¢)'}")
+        print("   æ—¶åºé•¿åº¦: 20å¤© (Time Step)")
 
         # è®­ç»ƒ
-        print("1. åˆå§‹åŒ–æ¨¡å‹ä¸æ•°æ®...")
+        print("\n1. åˆå§‹åŒ–æ¨¡å‹ä¸æ•°æ® (TSDatasetH)...")
+        # TSDatasetH ä¼šæŠŠæ•°æ®åˆ‡æˆ (Batch, Step, Feature) çš„ 3D å¼ é‡
         model = init_instance_by_config(task["model"])
         dataset = init_instance_by_config(task["dataset"])
 
-        print("2. å¼€å§‹è®­ç»ƒ (LightGBM)...")
+        print("2. å¼€å§‹ç‚¼ä¸¹ (Training Neural Network)...")
+        # è¿™ä¸€æ­¥ä¼šæ‰“å°æ¯ä¸ª Epoch çš„ Loss
         model.fit(dataset)
 
         # é¢„æµ‹ä¸ICåˆ†æ
@@ -130,19 +98,25 @@ if __name__ == "__main__":
         pred = model.predict(dataset)
         label = dataset.prepare(segments="test", col_set="label")
 
-        # ç®€å•å¯¹é½
+        # æ·±åº¦å­¦ä¹ å‡ºæ¥çš„ index å¯èƒ½ä¼šå¤æ‚ä¸€äº›ï¼Œåšä¸ªå¯¹å…¶
         if isinstance(pred, pd.DataFrame): pred = pred.iloc[:, 0]
         if isinstance(label, pd.DataFrame): label = label.iloc[:, 0]
 
+        # å–äº¤é›†
         idx = pred.index.intersection(label.index)
-        ic = pred.loc[idx].corr(label.loc[idx])
-        rank_ic = pred.loc[idx].rank().corr(label.loc[idx].rank())
+        pred = pred.loc[idx]
+        label = label.loc[idx]
+
+        # è®¡ç®— IC
+        ic = pred.corr(label)
+        rank_ic = pred.rank().corr(label.rank())
 
         print("-" * 50)
-        print(f"ğŸ“Š å®éªŒç»“æœ (Custom 5 Factors):")
+        print(f"ğŸ“Š å®éªŒç»“æœ (GRU Neural Network):")
         print(f"   Rank IC: {rank_ic:.4f}")
         print("-" * 50)
 
-        if rank_ic > 0.01:
-            print("âœ… å®éªŒæˆåŠŸï¼")
-            print("   è¿™è¯æ˜äº†ä½ å®Œå…¨æŒæ¡äº† Qlib çš„é…ç½®é€»è¾‘ï¼šHandler ç®¡è°ƒåº¦ï¼ŒProcessor ç®¡è®¡ç®—ã€‚")
\ No newline at end of file
+        if rank_ic > 0.03:
+            print("âœ… æ·±åº¦å­¦ä¹ æœ‰æ•ˆï¼")
+        else:
+            print("ğŸ¤” æ•ˆæœä¸€èˆ¬ã€‚æ·±åº¦å­¦ä¹ é€šå¸¸éœ€è¦æ›´å¤šçš„æ•°æ®å’Œæ›´ç²¾ç»†çš„è°ƒå‚ã€‚")
\ No newline at end of file
