diff --git a/python_program/.idea/.name b/python_program/.idea/.name
new file mode 100644
index 0000000..fadc7de
--- /dev/null
+++ b/python_program/.idea/.name
@@ -0,0 +1 @@
+04_analysis.py
\ No newline at end of file
diff --git a/python_program/.idea/vcs.xml b/python_program/.idea/vcs.xml
new file mode 100644
index 0000000..6c0b863
--- /dev/null
+++ b/python_program/.idea/vcs.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="VcsDirectoryMappings">
+    <mapping directory="$PROJECT_DIR$/.." vcs="Git" />
+  </component>
+</project>
\ No newline at end of file
diff --git a/python_program/05_model_gru.py b/python_program/05_model_gru.py
new file mode 100644
index 0000000..a28ea27
--- /dev/null
+++ b/python_program/05_model_gru.py
@@ -0,0 +1,148 @@
+import qlib
+from qlib.constant import REG_CN
+from qlib.utils import init_instance_by_config
+from qlib.workflow import R
+# ç›´æ¥ä½¿ç”¨å®˜æ–¹ç±»ï¼Œä¸æè‡ªå®šä¹‰ç»§æ‰¿äº†
+from qlib.data.dataset.handler import DataHandlerLP
+import pandas as pd
+import os
+
+# 1. åˆå§‹åŒ–
+provider_uri = r"E:\Quant_program\Qlib-Cache\cn_data"
+qlib.init(provider_uri=provider_uri, region=REG_CN)
+
+# 2. å®šä¹‰è‡ªå®šä¹‰å› å­ (çº¯å…¬å¼åˆ—è¡¨)
+custom_factors = [
+    "( $close - Mean($close, 5) ) / Mean($close, 5)",  # 5æ—¥ä¹–ç¦»
+    "$volume / Mean($volume, 20)",  # é‡æ¯”
+    "Std($close, 20) / $close",  # æ³¢åŠ¨ç‡
+    "($open - Ref($close, 1)) / Ref($close, 1)",  # éš”å¤œè·³ç©º
+    "($close - $open) / $open"  # æ—¥å†…åŠ›åº¦
+]
+
+# 3. é…ç½®å·¥ä½œæµ
+market = "csi300"
+benchmark = "SH000300"
+FIT_START = "2018-01-01"
+FIT_END = "2020-12-31"
+
+data_handler_config = {
+    "start_time": "2018-01-01",
+    "end_time": "2022-12-31",
+
+    # âš ï¸ã€å…³é”®ä¿®æ”¹ã€‘è¿™é‡Œåƒä¸‡ä¸è¦å†™ fit_start_timeï¼
+    # å¦‚æœå†™äº†ï¼ŒDataHandlerLP å°±ä¼šæŠ¥é”™ "unexpected argument"ã€‚
+    # "fit_start_time": FIT_START,  <-- åˆ é™¤
+    # "fit_end_time": FIT_END,      <-- åˆ é™¤
+
+    "instruments": market,
+
+    # æ•°æ®åŠ è½½é…ç½®
+    "data_loader": {
+        "class": "QlibDataLoader",
+        "module_path": "qlib.data.dataset.loader",
+        "kwargs": {
+            "config": {
+                "feature": custom_factors,
+                "label": ["Ref($close, -5) / $close - 1"],
+            },
+        },
+    },
+
+    # ğŸ”¥ğŸ”¥ğŸ”¥ã€å…³é”®ä¿®æ”¹ã€‘åœ¨è¿™é‡Œæ˜¾å¼æ³¨å…¥æ—¶é—´å‚æ•° ğŸ”¥ğŸ”¥ğŸ”¥
+    # è¿™æ ·åº•å±‚å¤„ç†å™¨èƒ½æ‹¿åˆ°å‚æ•°ï¼Œè€Œä¸Šå±‚ Handler åˆä¸ä¼šæŠ¥é”™
+    "infer_processors": [
+        {
+            "class": "RobustZScoreNorm",
+            "kwargs": {
+                "fields_group": "feature",
+                "clip_outlier": True,
+                "fit_start_time": FIT_START,  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
+                "fit_end_time": FIT_END  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
+            }
+        },
+        {"class": "Fillna", "kwargs": {"fields_group": "feature"}},
+    ],
+    "learn_processors": [
+        {"class": "DropnaLabel"},
+        {
+            "class": "CSRankNorm",
+            "kwargs": {
+                "fields_group": "label",
+                "fit_start_time": FIT_START,  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
+                "fit_end_time": FIT_END  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»ç»™
+            }
+        },
+    ],
+}
+
+task = {
+    "model": {
+        "class": "LGBModel",
+        "module_path": "qlib.contrib.model.gbdt",
+        "kwargs": {
+            "loss": "mse",
+            "colsample_bytree": 0.8879,
+            "learning_rate": 0.0421,
+            "subsample": 0.8789,
+            "lambda_l1": 205.6999,
+            "lambda_l2": 580.9768,
+            "max_depth": 8,
+            "num_leaves": 210,
+            "num_threads": 20,
+        },
+    },
+    "dataset": {
+        "class": "DatasetH",
+        "module_path": "qlib.data.dataset",
+        "kwargs": {
+            "handler": {
+                # ç›´æ¥ç”¨å®˜æ–¹ç±»ï¼Œé€šè¿‡é…ç½®è§£å†³é—®é¢˜
+                "class": "DataHandlerLP",
+                "module_path": "qlib.data.dataset.handler",
+                "kwargs": data_handler_config,
+            },
+            "segments": {
+                "train": (FIT_START, FIT_END),
+                "valid": ("2021-01-01", "2021-12-31"),
+                "test": ("2022-01-01", "2022-12-31"),
+            },
+        },
+    },
+}
+
+if __name__ == "__main__":
+    with R.start(experiment_name="research_custom_factors"):
+        print("ğŸ§ª æ­£åœ¨è¿›è¡Œè‡ªå®šä¹‰å› å­å®éªŒ (Precise Config)...")
+        print(f"å› å­æ•°é‡: {len(custom_factors)}")
+
+        # è®­ç»ƒ
+        print("1. åˆå§‹åŒ–æ¨¡å‹ä¸æ•°æ®...")
+        model = init_instance_by_config(task["model"])
+        dataset = init_instance_by_config(task["dataset"])
+
+        print("2. å¼€å§‹è®­ç»ƒ (LightGBM)...")
+        model.fit(dataset)
+
+        # é¢„æµ‹ä¸ICåˆ†æ
+        print("3. é¢„æµ‹ä¸è¯„ä¼°...")
+        recorder = R.get_recorder()
+        pred = model.predict(dataset)
+        label = dataset.prepare(segments="test", col_set="label")
+
+        # ç®€å•å¯¹é½
+        if isinstance(pred, pd.DataFrame): pred = pred.iloc[:, 0]
+        if isinstance(label, pd.DataFrame): label = label.iloc[:, 0]
+
+        idx = pred.index.intersection(label.index)
+        ic = pred.loc[idx].corr(label.loc[idx])
+        rank_ic = pred.loc[idx].rank().corr(label.loc[idx].rank())
+
+        print("-" * 50)
+        print(f"ğŸ“Š å®éªŒç»“æœ (Custom 5 Factors):")
+        print(f"   Rank IC: {rank_ic:.4f}")
+        print("-" * 50)
+
+        if rank_ic > 0.01:
+            print("âœ… å®éªŒæˆåŠŸï¼")
+            print("   è¿™è¯æ˜äº†ä½ å®Œå…¨æŒæ¡äº† Qlib çš„é…ç½®é€»è¾‘ï¼šHandler ç®¡è°ƒåº¦ï¼ŒProcessor ç®¡è®¡ç®—ã€‚")
\ No newline at end of file
